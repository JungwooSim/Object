# 15. 디자인 패턴과 프레임워크
소프트웨어 설계에서 반복적으로 발생하는 문제에 대해 반복적으로 적용할 수 있는 해결 방법을 **디자인 패턴**이라고 부른다.</br>
디자인 패턴의 목적은 설계를 재사용하는 것이다.</br>
디자인 패턴은 다양한 변경을 다루기 위해 반복적으로 재사용할 수 있는 설계의 묶음이다.</br>
디자인 패턴이 설계를 재사용하기 위한 것이라면 프레임워크는 설계와 코드를 함께 재사용하기 위한 것이다.</br>

### 01. 디자인 패턴과 설계 재사용

패턴이란 무엇인가를 논의할 때면 반복적으로 언급되는 몇 가지 핵심적인 특징이 있다.

- 패턴은 반복적으로 발생하는 문제와 해법의 쌍으로 정의된다.
- 패턴을 사용함으로써 이미 알려진 문제와 이에 대한 해법을 문서로 정리할 수 있으며, 이 지식을 다른 사람과 의사소통할 수 있다.
- 패턴은 추상적인 원칙과 실제 코드 작성 사이의 간극을 메워주며 실질적인 코드 작성을 돕는다.
- 패턴의 요점은 패턴이 실무에서 탄생했다는 점이다.

**패턴 분류**

패턴을 분류하는 가장 일반적인 방법은 패턴의 범위나 적용 단계에 따라 4가지로 분류할 수 있다.

- 아키텍처 패턴(Architecture Pattern)
- 분석 패턴(Analysis Pattern)
- 디자인 패턴(Design Pattern)
- 이디엄(Idiom)

디자인 패턴은 특정 정황 내에서 일반적인 설계 문제를 해결하며, 협력하는 컴포넌트들 사이에서 반복적으로 발생하는 구조를 서술한다.</br>
그리고 중간 규모의 패턴으로 특정한 설계 문제를 해결하는 것을 목적으로 하며, 프로그래밍 언어나 프로그래밍 패러다임에 독립적이다.</br>

디자인 패턴의 상위에는 소프트웨어의 전체적인 구조를 결정하기 위해 사용할 수 있는 아키텍처 패턴이 위치한다.</br>
아키텍처 패턴은 미리 정의된 서브시스템들을 제공하고, 각 서브시스템들의 책임을 정의하며, 서브시스템들 사이의 관계를 조직화하는 규칙과 가이드라인을 포함한다.</br>
그리고 구체적인 소프트웨어 아키텍처를 위한 템플릿을 제공하며, 디자인 패턴과 마찬가지로 프로그래밍 언어나 프로그래밍 패러다임에 독립적이다.</br>

디자인 패턴 하위에는 이디엄 이 위치한다.</br>
이디엄은 특정 프로그래밍 언어에만 국한된 하위 레벨 패턴으로, 주어진 언어의 기능을 사용해 컴포넌트, 혹은 컴포넌트 간의 특정 측면을 구현하는 방법을 서술한다.</br>
이디엄은 언어에 종속적이기 때문에 특정 언어의 이디엄이 다른 언어에서는 무용지물이 될 수 있다.</br>

분석 패턴은 도메인 내의 개념적인 문제를 해결하는데 초점을 맞춘다.</br>
분석 패턴은 업무 모델링 시에 발견되는 공통적인 구조를 표현하는 개념들의 집합이다.</br>

**캡슐화와 디자인 패턴**

<img src="/design_pattern-framework/img/15-5.png" width="500px;" />

위는 TEMPLATE METHOD 패턴의 전형적인 구현 방법이다.</br>
TEMPLATE METHOD 패턴은 부모 클래스가 알고리즘의 기본 구조를 정의하고 구체적인 단계는 클래스에서 정의함으로써 변경을 캡슐화할 수 있는 디자인 패턴이다.</br>
다만 합성보다는 결합도가 높은 상속을 사용했기 때문에 STRATEGY 패턴처럼 런타임에 객체의 알고리즘을 변경하는 것은 불가능하다.</br>
하지만 알고리즘 교체와 같은 요구사항이 없다면 상대적으로 STRATEGY 패턴보다 복잡도를 낮출 수 있다는 면에서 장점이라고 할 수 있다.</br>

<img src="/design_pattern-framework/img/15-6.png" width="500px;" />

위 [그림15-6]은 DECORATOR 패턴을 기반으로 한다.</br>
DECORATOR 패턴은 객체의 행동을 동적으로 추가할 수 있게 해주는 패턴으로서 기본적으로 객체의 행동을 결합하기 위해 객체 합성을 사용한다.</br>
DECORATOR 패턴은 선택적인 행동의 개수와 순서에 대한 변경을 캡슐화 할 수 있다.</br>

패턴은 출발점이다. 공통적인 문제에 적절한 해법을 제공하지만 공통적인 해법이 우리가 직면한 문제에 적합하지 않을 수도 있다.</br>
문제를 분석하고 창의력을 발휘함으로써 패턴을 현재의 문제에 적합하도록 적절하게 수정해야 한다.</br>
비록 패턴이 현재의 문제에 딱 들어맞지 않는다고 해도 참조할 수 있는 모범적인 역할과 책임의 집합을 알고 있는 것은 큰도움이 된다.</br>

### 02. 프레임워크와 코드 재사용

**코드 재사용 대 설계 재사용**

프레임워크란 '추상 클래스 나 인터페이스를 정의하고 인스턴스 사이의 상호작용을 통해 시스템 전체 혹은 일부를 구현해 놓은 재사용 가능한 설계', 또는 '애플리케이션 개발자가 현재의 요구사항에 맞게 커스터마이징할 수 있는 애플리케이션의 골격(skeleton)'을 의미한다.

첫 번째 정의가 프레임워크의 구조적인 측면에 초점을 맞추고 있다면 두 번째 정의는 코드와 설계의 재사용이라는 프레임워크의 사용 목적에 초점을 맞춘다.

프레임워크는 코드를 재사용함으로써 설계 아이디어를 재사용 한다.

**제어 역전 원리**

의존성 역전 원리는 프레임워크의 가장 기본적인 설계 메커니즘 이다.</br>
의존성 역전은 의존성의 방향뿐만 아니라 제어 흐름의 주체 역시 역전시킨다.</br>
그러나 의존성을 역전시킨 객체지향 구조에서는 반대로 프레임워크가 애플리케이션에 속하는 서브클래스의 메서드를 호출한다.</br>
따라서 프레임워크를 사용할 경우 개별 애플리케이션에서 프레임워크로 제어 흐름의 주체가 이동한다.</br>
즉, 의존성을 역전시키면 제어 흐름의 주체 역시 역전된다. 이를 **제어 역전(Inversion of Control) 원리**, 또는 **할리우드(Hollywood) 원리**라고 한다.</br>

<img src="/design_pattern-framework/img/15-10.png" width="500px;" />

[그림15-10]은 핸드폰 과금 시스템의 프레임워크의 요소들을 이용해 기본 정책의 협력을 나타낸 것이다.

그림에서 전체적인 협력 흐름은 프레임워크에 정의돼 있다.</br>
특정한 기본 정책을 구현하는 개발자는 FeeCondition을 대체할 서브타입만 개발하면 프레임워크에 정의된 플로우에 따라 요금이 계산된다.</br>
프레임워크에서는 일반적인 해결책만 제공하고 애플리케이션에 따라 달라질 수 있는 특정한 동작은 비워둔다.</br>
이렇게 완성되지 않은 채로 남겨진 동작을 훅(hook)이라고 부른다.</br>
